<!DOCTYPE html>
<!-- START: inst/pkgdown/templates/layout.html --><!-- Generated by pkgdown: do not edit by hand --><html lang="en" data-bs-theme="auto"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><title>Multiple Testing: Pairwise comparisons</title><meta name="viewport" content="width=device-width, initial-scale=1"><script src="assets/themetoggle.js"></script><link rel="stylesheet" type="text/css" href="assets/styles.css"><script src="assets/scripts.js" type="text/javascript"></script><!-- mathjax --><script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      config: ["MMLorHTML.js"],
      jax: ["input/TeX","input/MathML","output/HTML-CSS","output/NativeMML", "output/PreviewHTML"],
      extensions: ["tex2jax.js","mml2jax.js","MathMenu.js","MathZoom.js", "fast-preview.js", "AssistiveMML.js", "a11y/accessibility-menu.js"],
      TeX: {
        extensions: ["AMSmath.js","AMSsymbols.js","noErrors.js","noUndefined.js"]
      },
      tex2jax: {
        inlineMath: [['\\(', '\\)']],
        displayMath: [ ['$$','$$'], ['\\[', '\\]'] ],
        processEscapes: true
      }
    });
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><!-- Responsive Favicon for The Carpentries --><link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png"><link rel="manifest" href="site.webmanifest"><link rel="mask-icon" href="safari-pinned-tab.svg" color="#5bbad5"><meta name="msapplication-TileColor" content="#da532c"><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="black"></head><body>
    <header id="top" class="navbar navbar-expand-md top-nav incubator"><svg xmlns="http://www.w3.org/2000/svg" class="d-none"><symbol id="check2" viewbox="0 0 16 16"><path d="M13.854 3.646a.5.5 0 0 1 0 .708l-7 7a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L6.5 10.293l6.646-6.647a.5.5 0 0 1 .708 0z"></path></symbol><symbol id="circle-half" viewbox="0 0 16 16"><path d="M8 15A7 7 0 1 0 8 1v14zm0 1A8 8 0 1 1 8 0a8 8 0 0 1 0 16z"></path></symbol><symbol id="moon-stars-fill" viewbox="0 0 16 16"><path d="M6 .278a.768.768 0 0 1 .08.858 7.208 7.208 0 0 0-.878 3.46c0 4.021 3.278 7.277 7.318 7.277.527 0 1.04-.055 1.533-.16a.787.787 0 0 1 .81.316.733.733 0 0 1-.031.893A8.349 8.349 0 0 1 8.344 16C3.734 16 0 12.286 0 7.71 0 4.266 2.114 1.312 5.124.06A.752.752 0 0 1 6 .278z"></path><path d="M10.794 3.148a.217.217 0 0 1 .412 0l.387 1.162c.173.518.579.924 1.097 1.097l1.162.387a.217.217 0 0 1 0 .412l-1.162.387a1.734 1.734 0 0 0-1.097 1.097l-.387 1.162a.217.217 0 0 1-.412 0l-.387-1.162A1.734 1.734 0 0 0 9.31 6.593l-1.162-.387a.217.217 0 0 1 0-.412l1.162-.387a1.734 1.734 0 0 0 1.097-1.097l.387-1.162zM13.863.099a.145.145 0 0 1 .274 0l.258.774c.115.346.386.617.732.732l.774.258a.145.145 0 0 1 0 .274l-.774.258a1.156 1.156 0 0 0-.732.732l-.258.774a.145.145 0 0 1-.274 0l-.258-.774a1.156 1.156 0 0 0-.732-.732l-.774-.258a.145.145 0 0 1 0-.274l.774-.258c.346-.115.617-.386.732-.732L13.863.1z"></path></symbol><symbol id="sun-fill" viewbox="0 0 16 16"><path d="M8 12a4 4 0 1 0 0-8 4 4 0 0 0 0 8zM8 0a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 0zm0 13a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 13zm8-5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2a.5.5 0 0 1 .5.5zM3 8a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2A.5.5 0 0 1 3 8zm10.657-5.657a.5.5 0 0 1 0 .707l-1.414 1.415a.5.5 0 1 1-.707-.708l1.414-1.414a.5.5 0 0 1 .707 0zm-9.193 9.193a.5.5 0 0 1 0 .707L3.05 13.657a.5.5 0 0 1-.707-.707l1.414-1.414a.5.5 0 0 1 .707 0zm9.193 2.121a.5.5 0 0 1-.707 0l-1.414-1.414a.5.5 0 0 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .707zM4.464 4.465a.5.5 0 0 1-.707 0L2.343 3.05a.5.5 0 1 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .708z"></path></symbol></svg><a class="visually-hidden-focusable skip-link" href="#main-content">Skip to main content</a>
  <div class="container-fluid top-nav-container">
    <div class="col-md-8">
      <div class="large-logo">
        <img id="incubator-logo" alt="Carpentries Incubator" src="assets/images/incubator-logo.svg"><span class="badge text-bg-danger">
          <abbr title="This lesson is in the pre-alpha phase, which means that it is in early development, but has not yet been taught.">
            <a href="https://cdh.carpentries.org/the-lesson-life-cycle.html#early-development-pre-alpha-through-alpha" class="external-link alert-link">
              <i aria-hidden="true" class="icon" data-feather="alert-octagon" style="border-radius: 5px"></i>
              Pre-Alpha
            </a>
            <span class="visually-hidden">This lesson is in the pre-alpha phase, which means that it is in early development, but has not yet been taught.</span>
          </abbr>
        </span>

      </div>
    </div>
    <div class="selector-container">
      <div id="theme-selector">
        <li class="nav-item dropdown" id="theme-button-list">
          <button class="btn btn-link nav-link px-0 px-lg-2 dropdown-toggle d-flex align-items-center" id="bd-theme" type="button" aria-expanded="false" data-bs-toggle="dropdown" data-bs-display="static" aria-label="Toggle theme (auto)">
            <svg class="bi my-1 theme-icon-active"><use href="#circle-half"></use></svg><i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="bd-theme-text"><li>
              <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="light" aria-pressed="false">
                <svg class="bi me-2 theme-icon"><use href="#sun-fill"></use></svg>
                Light
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
            <li>
              <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="dark" aria-pressed="false">
                <svg class="bi me-2 theme-icon"><use href="#moon-stars-fill"></use></svg>
                Dark
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
            <li>
              <button type="button" class="btn dropdown-item d-flex align-items-center active" data-bs-theme-value="auto" aria-pressed="true">
                <svg class="bi me-2 theme-icon"><use href="#circle-half"></use></svg>
                Auto
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
          </ul></li>
      </div>

      <div class="dropdown" id="instructor-dropdown">
        <button class="btn btn-secondary dropdown-toggle bordered-button" type="button" id="dropdownMenu1" data-bs-toggle="dropdown" aria-expanded="false">
          <i aria-hidden="true" class="icon" data-feather="eye"></i> Learner View <i data-feather="chevron-down"></i>
        </button>
        <ul class="dropdown-menu" aria-labelledby="dropdownMenu1"><li><button class="dropdown-item" type="button" onclick="window.location.href='instructor/Pairwise-comparisons.html';">Instructor View</button></li>
        </ul></div>
    </div>
  </div>
  <hr></header><nav class="navbar navbar-expand-xl bottom-nav incubator" aria-label="Main Navigation"><div class="container-fluid nav-container">
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle Navigation">
      <span class="navbar-toggler-icon"></span>
      <span class="menu-title">Menu</span>
    </button>
    <div class="nav-logo">
      <img class="small-logo" alt="Carpentries Incubator" src="assets/images/incubator-logo-sm.svg"></div>
    <div class="lesson-title-md">
      Multiple Testing
    </div>
    <div class="search-icon-sm">
      <!-- TODO: do not show until we have search
        <i role="img" aria-label="Search the All In One page" data-feather="search"></i>
      -->
    </div>
    <div class="desktop-nav">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0"><li class="nav-item">
          <span class="lesson-title">
            Multiple Testing
          </span>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="key-points.html">Key Points</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="reference.html#glossary">Glossary</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="profiles.html">Learner Profiles</a>
        </li>
        <li class="nav-item dropdown">
          <button class="nav-link dropdown-toggle" id="navbarDropdown" data-bs-toggle="dropdown" aria-expanded="false">
            More <i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu" aria-labelledby="navbarDropdown"><li><a class="dropdown-item" href="reference.html">Reference</a></li>
          </ul></li>
      </ul></div>
    <!--
    <form class="d-flex col-md-2 search-form">
      <fieldset disabled>
      <input class="form-control me-2 searchbox" type="search" placeholder="" aria-label="">
        <button class="btn btn-outline-success tablet-search-button"  type="submit">
          <i class="search-icon" data-feather="search" role="img" aria-label="Search the All In One page"></i>
        </button>
      </fieldset>
    </form>
    -->
    <a id="search-button" class="btn btn-primary" href="aio.html" role="button" aria-label="Search the All In One page">Search the All In One page</a>
  </div><!--/div.container-fluid -->
</nav><div class="col-md-12 mobile-title">
  Multiple Testing
</div>

<aside class="col-md-12 lesson-progress"><div style="width: 74%" class="percentage">
    74%
  </div>
  <div class="progress incubator">
    <div class="progress-bar incubator" role="progressbar" style="width: 74%" aria-valuenow="74" aria-label="Lesson Progress" aria-valuemin="0" aria-valuemax="100">
    </div>
  </div>
</aside><div class="container">
      <div class="row">
        <!-- START: inst/pkgdown/templates/navbar.html -->
<div id="sidebar-col" class="col-lg-4">
  <div id="sidebar" class="sidebar">
      <nav aria-labelledby="flush-headingEleven"><button role="button" aria-label="close menu" alt="close menu" aria-expanded="true" aria-controls="sidebar" class="collapse-toggle" data-collapse="Collapse " data-episodes="Episodes ">
          <i class="search-icon" data-feather="x" role="img"></i>
        </button>
        <div class="sidebar-inner">
          <div class="row mobile-row" id="theme-row-mobile">
            <div class="col" id="theme-selector">
              <li class="nav-item dropdown" id="theme-button-list">
                <button class="btn btn-link nav-link px-0 px-lg-2 dropdown-toggle d-flex align-items-center" id="bd-theme" type="button" aria-expanded="false" data-bs-toggle="dropdown" data-bs-display="static" aria-label="Toggle theme (auto)">
                  <svg class="bi my-1 theme-icon-active"><use href="#circle-half"></use></svg><span class="d-lg-none ms-1" id="bd-theme-text">Toggle Theme</span>
                </button>
                <ul class="dropdown-menu dropdown-menu-right" aria-labelledby="bd-theme-text"><li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="light" aria-pressed="false">
                      <svg class="bi me-2 theme-icon"><use href="#sun-fill"></use></svg>
                      Light
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                  <li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="dark" aria-pressed="false">
                      <svg class="bi me-2 theme-icon"><use href="#moon-stars-fill"></use></svg>
                      Dark
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                  <li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center active" data-bs-theme-value="auto" aria-pressed="true">
                      <svg class="bi me-2 theme-icon"><use href="#circle-half"></use></svg>
                      Auto
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                </ul></li>
            </div>
          </div>
          <div class="row mobile-row">
            <div class="col">
              <div class="sidenav-view-selector">
                <div class="accordion accordion-flush" id="accordionFlush9">
                  <div class="accordion-item">
                    <h2 class="accordion-header" id="flush-headingNine">
                      <button class="accordion-button collapsed" id="instructor" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseNine" aria-expanded="false" aria-controls="flush-collapseNine">
                        <i id="eye" aria-hidden="true" class="icon" data-feather="eye"></i> Learner View
                      </button>
                    </h2>
                    <div id="flush-collapseNine" class="accordion-collapse collapse" aria-labelledby="flush-headingNine" data-bs-parent="#accordionFlush2">
                      <div class="accordion-body">
                        <a href="instructor/Pairwise-comparisons.html">Instructor View</a>
                      </div>
                    </div>
                  </div><!--/div.accordion-item-->
                </div><!--/div.accordion-flush-->
              </div><!--div.sidenav-view-selector -->
            </div><!--/div.col -->

            <hr></div><!--/div.mobile-row -->

          <div class="accordion accordion-flush" id="accordionFlush11">
            <div class="accordion-item">

              <button id="chapters" class="accordion-button show" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseEleven" aria-expanded="false" aria-controls="flush-collapseEleven">
                <h2 class="accordion-header chapters" id="flush-headingEleven">
                  EPISODES
                </h2>
              </button>
              <div id="flush-collapseEleven" class="accordion-collapse show collapse" aria-labelledby="flush-headingEleven" data-bs-parent="#accordionFlush11">

                <div class="accordion-body">
                  <div class="accordion accordion-flush" id="accordionFlush1">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading1">
        <a href="index.html">Summary and Setup</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush2">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading2">
        <a href="What-is-multiple-testing.html">1. What is multiple testing</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush3">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading3">
        <a href="Types-of-errors.html">2. Types of errors and error rates</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush4">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading4">
        <a href="Family-wise-error-rate.html">3. Family-wise error rate</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush5">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading5">
        <a href="False-discovery-rate.html">4. False discovery rate</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlushcurrent">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-headingcurrent">
        <span class="visually-hidden">Current Chapter</span>
        <span class="current-chapter">
        5. Pairwise comparisons
        </span>
      
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush7">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading7">
        <a href="Summary.html">6. Summary</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush8">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading8">
        <a href="References.html">7. References and Further Reading</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

                </div>
              </div>
            </div>

            <hr class="half-width"><div class="accordion accordion-flush lesson-resources" id="accordionFlush12">
              <div class="accordion-item">
                <h2 class="accordion-header" id="flush-headingTwelve">
                  <button class="accordion-button collapsed" id="lesson-resources" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseTwelve" aria-expanded="false" aria-controls="flush-collapseTwelve">
                    RESOURCES
                  </button>
                </h2>
                <div id="flush-collapseTwelve" class="accordion-collapse collapse" aria-labelledby="flush-headingTwelve" data-bs-parent="#accordionFlush12">
                  <div class="accordion-body">
                    <ul><li>
                        <a href="key-points.html">Key Points</a>
                      </li>
                      <li>
                        <a href="reference.html#glossary">Glossary</a>
                      </li>
                      <li>
                        <a href="profiles.html">Learner Profiles</a>
                      </li>
                      <li><a href="reference.html">Reference</a></li>
                    </ul></div>
                </div>
              </div>
            </div>
            <hr class="half-width lesson-resources"><a href="aio.html">See all in one page</a>


            <hr class="d-none d-sm-block d-md-none"><div class="d-grid gap-1">

            </div>
          </div><!-- /div.accordion -->
        </div><!-- /div.sidebar-inner -->
      </nav></div><!-- /div.sidebar -->
  </div><!-- /div.sidebar-col -->
<!-- END:   inst/pkgdown/templates/navbar.html-->

        <!-- START: inst/pkgdown/templates/content-instructor.html -->
  <div class="col-xl-8 col-lg-12 primary-content">
    <nav class="lesson-content mx-md-4" aria-label="Previous and Next Chapter"><!-- content for small screens --><div class="d-block d-sm-block d-md-none">
        <a class="chapter-link" href="False-discovery-rate.html"><i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>Previous</a>
        <a class="chapter-link float-end" href="Summary.html">Next<i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i></a>
      </div>
      <!-- content for large screens -->
      <div class="d-none d-sm-none d-md-block">
        <a class="chapter-link" href="False-discovery-rate.html" rel="prev">
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>
          Previous: False discovery rate
        </a>
        <a class="chapter-link float-end" href="Summary.html" rel="next">
          Next: Summary...
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i>
        </a>
      </div>
      <hr></nav><main id="main-content" class="main-content"><div class="container lesson-content">
        <h1>Pairwise comparisons</h1>
        <p>Last updated on 2024-09-03 |

        <a href="https://example.com/FIXME-template-source/edit/main/episodes/Pairwise-comparisons.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>



        <div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>

        

<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul><li>What are pairwise comparisons, and how do they relate to the broader
concept of multiple testing in statistical analysis?</li>
<li>How can we effectively conduct and interpret pairwise comparisons to
make valid statistical inferences while controlling for the family-wise
error rate?</li>
</ul></div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul><li>Understand the Concept of Pairwise Comparisons</li>
<li>Learn how to conduct and interpret Pairwise Comparisons</li>
</ul></div>
</div>
</div>
</div>
</div>
<div class="section level1">
<h1 id="pairwise-comparisons">Pairwise comparisons<a class="anchor" aria-label="anchor" href="#pairwise-comparisons"></a></h1>
<p>Pairwise comparisons are a fundamental concept in statistical
analysis, allowing us to compare the means or proportions of multiple
groups or conditions. In this episode, we will explore the concept of
pairwise comparisons, their importance in statistical testing, and how
they relate to the broader context of multiple testing.</p>
<div class="section level2">
<h2 id="an-example-air-pollution-in-four-different-exposure-groups">An example: Air pollution in four different exposure groups<a class="anchor" aria-label="anchor" href="#an-example-air-pollution-in-four-different-exposure-groups"></a></h2>
<p>In our example of air pollution, fine particulate matter and other
pollutants can induce systemic inflammation in the body, leading to an
increase in circulating inflammatory markers like C-reactive protein
(CRP). Suppose we decide to divide the population into four groups based
on different levels of exposure to air pollution. Lets assume these
groups are as follow:</p>
<ul><li>Low exposure: Individuals living in rural areas with minimal
industrial activity and low traffic density.</li>
<li>Moderate exposure: Individuals living in suburban areas with some
industrial activity and moderate traffic density.</li>
<li>High exposure: Individuals living in urban areas with significant
industrial activity and high traffic density.</li>
<li>Very high exposure: Individuals living near industrial zones, major
highways, or heavily polluted urban areas.</li>
</ul><p>The table below shows the first six rows of CRP values of individuals
in the four exposure groups.</p>
<table class="table"><caption>CRP values of individuals in the four exposure groups</caption>
<thead><tr class="header"><th align="right">CRP</th>
<th align="left">Exposure</th>
</tr></thead><tbody><tr class="odd"><td align="right">1.379049</td>
<td align="left">Low</td>
</tr><tr class="even"><td align="right">2.039645</td>
<td align="left">Low</td>
</tr><tr class="odd"><td align="right">5.617417</td>
<td align="left">Low</td>
</tr><tr class="even"><td align="right">2.641017</td>
<td align="left">Low</td>
</tr><tr class="odd"><td align="right">2.758576</td>
<td align="left">Low</td>
</tr><tr class="even"><td align="right">5.930130</td>
<td align="left">Low</td>
</tr></tbody></table><p>In this case the “Exposure” column is a categorical variable with
four groups of exposure levels (<code>Low</code>, <code>Moderate</code>,
<code>High</code>, and <code>Very_high</code>).</p>
<div id="coding-along" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="coding-along" class="callout-inner">
<h3 class="callout-title">Coding along</h3>
<div class="callout-content">
<p>If you like to reproduce the example we use here, you can download
the data as follows:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">exp_data</span> <span class="op">&lt;-</span> <span class="fu">read_csv</span><span class="op">(</span>file<span class="op">=</span><span class="fu">url</span><span class="op">(</span><span class="st">"https://raw.githubusercontent.com/sarahkaspar/Multiple-Testing-tutorial-project/main/episodes/data/exposure_data.csv"</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
</div>
</div>
</div>
<p>Here, we visualize the data as a boxplot, together with the
individual data points:</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Visualize the data</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">exp_data</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Exposure</span>, y <span class="op">=</span> <span class="va">CRP</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_boxplot</span><span class="op">(</span>coef <span class="op">=</span> <span class="fl">5</span>, fill <span class="op">=</span> <span class="st">"lightblue"</span>, alpha <span class="op">=</span> <span class="fl">0.25</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span>position <span class="op">=</span> <span class="fu">position_jitter</span><span class="op">(</span>width <span class="op">=</span> <span class="fl">.1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Boxplot of Four Exposure Groups"</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/Pairwise-comparisons-rendered-unnamed-chunk-2-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><div id="pairwise-comparisons-1" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="pairwise-comparisons-1" class="callout-inner">
<h3 class="callout-title">Pairwise comparisons</h3>
<div class="callout-content">
<p>In the above example:</p>
<ul><li>How many pairwise comparisons are possible?</li>
<li>What is a suitable test for making these comparisons?</li>
<li>If we choose <span class="math inline">\(\alpha =0.05\)</span>, what
is the probability of seeing at least one significant difference, if in
fact all differences are 0?</li>
</ul></div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<ul><li>6 pairwise comparisons are possible.</li>
<li>t-test</li>
<li><span class="math inline">\(1-(0.95)^6 \approx 0.26\)</span></li>
</ul></div>
</div>
</div>
</div>
</div>
<div class="section level2">
<h2 id="defining-the-question">Defining the question<a class="anchor" aria-label="anchor" href="#defining-the-question"></a></h2>
<p>Generally, from the above plot, as the exposure level increases from
low to very high, we might expect to see a corresponding increase in the
median exposure level and higher median C-reactive protein (CRP)
values.</p>
<p>On this type of data, we can run different types of analyses,
depending on the question we ask. Let’s look at two different
scenarios:</p>
<ul><li><p><strong>Scenario 1:</strong> This is an exploratory analysis. We
are interested in finding out whether there is any difference between
the four exposure groups at all.</p></li>
<li><p><strong>Scenario 2:</strong> We have one or more particular
exposure groups of interest, which we like to compare to the low
exposure group. In this case, the low exposure group serves as a
reference.</p></li>
</ul><div class="section level3">
<h3 id="scenario-1-anova">Scenario 1: ANOVA<a class="anchor" aria-label="anchor" href="#scenario-1-anova"></a></h3>
<p>In this scenario, we’re basically comparing all against all.</p>
<p>Our <strong>null hypothesis</strong> is that there are not any
differences in CRP amounts in the different groups. From the challenge
above, we learned that 6 individual comparisons are not unlikely to
produce at least one false positive. In case that there are no
differences at all, this probability is estimated to be <span class="math inline">\(P=0.26\)</span>.</p>
<p>Recall that in this situation, we like to control for the family-wise
error rate. Our null hypothesis is that there’s nothing going on at all,
and once we reject the null for one of our individual comparisons, we
also reject this overall null hypothesis.</p>
<p>In this kind of situation, the ANOVA F-test is the method of choice.
It is a method that</p>
<ul><li>is used to compare means between different groups and</li>
<li>controls for the family-wise error rate.</li>
<li>It’s applicable when the data points are normally distributed around
the group means and the variances are similar among the groups. This
appears to be the case in our example.</li>
</ul><p>In general, a one-way ANOVA for <span class="math inline">\(t\)</span> groups tests the null hypothesis:</p>
<p><span class="math display">\[H_0: \mu_1 = \mu_2 = ... =
\mu_t,\]</span> where <span class="math inline">\(\mu_i\)</span> is the
mean of population <span class="math inline">\(i\)</span>.</p>
<p>The alternative hypothesis is:</p>
<p><span class="math display">\[H_A: \mu_i \neq \mu_j \text{ for some i
and j where i}\neq \text{j}\]</span></p>
<p>For this, we use an F-statistic:</p>
<p><span class="math display">\[F= \frac{\text{between group
variance}}{\text{within group variance}}\]</span> <span class="math inline">\(F\)</span> becomes large, if the groups differ
strongly in their group means, while the variance within the groups is
small. ANOVA is closely related to the t-test. In fact, if we perform an
ANOVA on a data set with two groups only, it is equivalent to performing
a t-test. For more details on ANOVA, see <a href="https://online.stat.psu.edu/stat500/lesson/10/10.2" class="external-link">the PennState
online materials</a>.</p>
<p>We can perform an ANOVA in R as follows:</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">anova_result</span> <span class="op">&lt;-</span> <span class="fu">aov</span><span class="op">(</span><span class="va">CRP</span> <span class="op">~</span> <span class="va">Exposure</span>, data <span class="op">=</span> <span class="va">exp_data</span><span class="op">)</span></span>
<span><span class="fu">summary</span><span class="op">(</span><span class="va">anova_result</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>             Df Sum Sq Mean Sq F value  Pr(&gt;F)
Exposure      3   60.8  20.268   5.754 0.00086 ***
Residuals   196  690.4   3.523
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<p>The ANOVA output above shows statistically significant differences
among the means of the four exposure groups. We therefore reject the
null hypothesis of equal means.</p>
</div>
<div class="section level3">
<h3 id="post-hoc-tests">Post-hoc tests<a class="anchor" aria-label="anchor" href="#post-hoc-tests"></a></h3>
<p>ANOVA alone does not tell us which specific groups differ
significantly from each other. To determine this, we need to conduct
further analysis. Post-hoc tests are follow up procedures, used to
compare pairs of groups in order to identify where the differences lie.
These tests provide more detailed information about which specific group
means are different from each other.</p>
<p>Parametric methods, such as Tukey’s HSD, are used when assumptions of
normality and homogeneity of variance are met. Non-parametric methods,
such as pairwise Wilcoxon tests, are suitable when data do not meet the
assumptions of parametric tests. In R, performing pairwise comparisons
is straightforward using built-in functions and packages. We perform a
Tukey post-hoc test using <code>TukeyHSD()</code> to determine which
specific exposure group means differ significantly from each other.</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tukey_result</span> <span class="op">&lt;-</span> <span class="fu">TukeyHSD</span><span class="op">(</span><span class="va">anova_result</span><span class="op">)</span></span>
<span><span class="va">tukey_result</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>  Tukey multiple comparisons of means
    95% family-wise confidence level

Fit: aov(formula = CRP ~ Exposure, data = exp_data)

$Exposure
                         diff        lwr       upr     p adj
Low-High           -0.4233920 -1.3960536 0.5492695 0.6727404
Moderate-High       0.3006174 -0.6720442 1.2732790 0.8539510
Very_high-High      1.0854145  0.1127530 2.0580761 0.0219956
Moderate-Low        0.7240094 -0.2486521 1.6966710 0.2193881
Very_high-Low       1.5088066  0.5361450 2.4814681 0.0004795
Very_high-Moderate  0.7847971 -0.1878644 1.7574587 0.1597266</code></pre>
</div>
<p>The results provide pairwise comparisons of group means including</p>
<ul><li>
<code>diff</code>: the estimated difference between the two
groups</li>
<li>the lower (<code>lrw</code>) and upper (<code>upr</code>) bounds of
a 95% family-wise confidence interval and</li>
<li>
<code>p adj</code>: the adjusted p-value which can be used to
control for the FWER.</li>
</ul><p>You often read that the Tukey procedure calculates <em>simultaneous
confidence intervals</em>, which implies that the confidence intervals
are dependent on how many comparisons we make. They grow (more
uncertainty), the more comparisons we make, and they can also be used to
determine whether two groups are significantly different. In the plot
below, each comparison has an estimate, and a confidence interval. We
call the difference significant with a 95% family-wise confidence level,
if the confidence interval <em>excludes 0</em>.</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">multcompView</span><span class="op">)</span></span>
<span><span class="fu">par</span><span class="op">(</span>mar<span class="op">=</span><span class="fu">c</span><span class="op">(</span><span class="fl">5</span>,<span class="fl">6</span>,<span class="fl">4</span>,<span class="fl">1</span><span class="op">)</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu">plot</span><span class="op">(</span><span class="va">tukey_result</span>, </span>
<span>     las<span class="op">=</span><span class="fl">1</span>,</span>
<span>     cex.axis<span class="op">=</span><span class="fl">0.7</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/Pairwise-comparisons-rendered-unnamed-chunk-4-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure></div>
<div class="section level3">
<h3 id="interpreting-pairwise-comparison-results">Interpreting Pairwise Comparison Results<a class="anchor" aria-label="anchor" href="#interpreting-pairwise-comparison-results"></a></h3>
<p>Adjusted p-values reflect the probability of observing a given result
(or more extreme) under the assumption that all null hypotheses are
true, while accounting for the number of comparisons made. Here, we
interpret pairwise comparison results with adjusted p-values from the
Tukey test by assessing whether the adjusted p-value is less than the
chosen significance level (α) (0.05). If the adjusted p-value is below
the significance level, we conclude that the observed difference is
statistically significant after correcting for multiple comparisons.</p>
<p>In our example above, we observe significant differences in CRP
level</p>
<ul><li>between the exposure groups <code>very_high</code> and
<code>high</code>
</li>
<li>between the exposure groups <code>very_high</code> and
<code>low</code>
</li>
</ul><p>Consistent with that, the respective confidence intervals of these
two comparisons exclude zero.</p>
</div>
</div>
<div class="section level2">
<h2 id="scenario-2">Scenario 2<a class="anchor" aria-label="anchor" href="#scenario-2"></a></h2>
<p>In the second scenario, we aim to determine risk areas of increased
CRP concentration. Our control are low exposure regions, and we aim to
find out which of the other groups differ significantly from the control
in terms of CRP concentration, which classifies them as risk
regions.</p>
<p>If this is our question, in theory, we don’t need all six
comparisons. We just want to compare each group to the control. In
biology, this is a common scenario. We might have a small screen, where
we test several substances against a control, and need to determine
which of these has an effect. In this scenario, Tukey is overly
conservative, because it corrects for more tests than we actually like
to perform. We can, however apply the <em>Dunnett procedure</em>,
which</p>
<ul><li>controls for the FWER<br></li>
<li>in a scenario where we’d like to compare a number of groups to a
control.</li>
</ul><p>We can run the Dunnett test in R by using the function
<code>DunnettTest</code>. As input, we supply</p>
<ul><li>
<code>x</code>: a numeric vector of data values, or a list of
numeric data vectors</li>
<li>
<code>g</code>: a vector or factor object giving the group for the
corresponding elements of x</li>
<li>
<code>control</code>: the level of the control group against which
the others should be tested</li>
</ul><div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">DescTools</span><span class="op">)</span></span>
<span><span class="va">dunnett</span> <span class="op">&lt;-</span> <span class="fu">DunnettTest</span><span class="op">(</span>x <span class="op">=</span><span class="va">exp_data</span><span class="op">$</span><span class="va">CRP</span>, </span>
<span>            g<span class="op">=</span> <span class="va">exp_data</span><span class="op">$</span><span class="va">Exposure</span>, </span>
<span>            control <span class="op">=</span> <span class="st">"Low"</span><span class="op">)</span></span>
<span><span class="va">dunnett</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
  Dunnett's test for comparing several treatments with a control :
    95% family-wise confidence level

$Low
                   diff     lwr.ci   upr.ci    pval
High-Low      0.4233920 -0.4652856 1.312070 0.53610
Moderate-Low  0.7240094 -0.1646682 1.612687 0.13711
Very_high-Low 1.5088066  0.6201290 2.397484 0.00023 ***

---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">par</span><span class="op">(</span>mar<span class="op">=</span><span class="fu">c</span><span class="op">(</span><span class="fl">5.1</span>, <span class="fl">7.1</span>, <span class="fl">4.1</span>, <span class="fl">1.1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">plot</span><span class="op">(</span><span class="va">dunnett</span>, las<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/Pairwise-comparisons-rendered-unnamed-chunk-6-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><div id="discussion" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="discussion" class="callout-inner">
<h3 class="callout-title">Discussion</h3>
<div class="callout-content">
<p>Why can’t we just run t-tests and then apply Bonferoni?</p>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2"> Show me the solution </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" aria-labelledby="headingSolution2" data-bs-parent="#accordionSolution2">
<div class="accordion-body">
<p>This would not be wrong. It doesn’t produce confidence intervals
though. It’s sometimes a matter of convention.</p>
</div>
</div>
</div>
</div>
<div id="be-honest" class="callout testimonial">
<div class="callout-square">
<i class="callout-icon" data-feather="heart"></i>
</div>
<div id="be-honest" class="callout-inner">
<h3 class="callout-title">Be honest!</h3>
<div class="callout-content">
<p>In some cases, Dunnett is the way to go. But take a minute and think
about whether you’re not interested in the other comparisons as well.
For instance, when studying air pollution in different groups, you might
also be interested in whether there are differences between moderate and
high exposure. The fact that we don’t <em>see</em> large differences
between those two groups in the data is <em>not</em> a good reason for
leaving out this comparison!</p>
</div>
</div>
</div>
</div>
<div class="section level2">
<h2 id="pretty-figures">Pretty figures<a class="anchor" aria-label="anchor" href="#pretty-figures"></a></h2>
<p>In publications, you often find p-values plotted next to the
comparison in a figure. These plots can be produced in R.</p>
<div id="publication-ready-plots" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="publication-ready-plots" class="callout-inner">
<h3 class="callout-title">Publication-ready plots</h3>
<div class="callout-content">
<p>The R package <code>ggpubr</code> comes with the promise of producing
publication-ready plots. Let’s explore some of the functions and
practice our plotting skills. We use the <code>PlantGrowth</code> data
set.</p>
<ol style="list-style-type: decimal"><li>Explore the data set. Which variables are there?</li>
<li>Use the following template to create a meaningful plot, comparing
the groups in the data set using ANOVA. You can look up the function
<code>stat_compare_means</code> in the R help section.</li>
</ol><div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">ggpubr</span><span class="op">)</span> <span class="co"># load the required library</span></span>
<span></span>
<span><span class="va">PlantGrowth</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span>, y<span class="op">=</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">geom_jitter</span><span class="op">(</span>width<span class="op">=</span><span class="fl">0.1</span><span class="op">)</span><span class="op">+</span> <span class="co"># feel free to replace by, or add, another type of plot</span></span>
<span>  <span class="fu">stat_compare_means</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
</div>
</div>
</div>
<div id="accordionSolution3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution3" aria-expanded="false" aria-controls="collapseSolution3">
  <h4 class="accordion-header" id="headingSolution3"> Show me the solution </h4>
</button>
<div id="collapseSolution3" class="accordion-collapse collapse" aria-labelledby="headingSolution3" data-bs-parent="#accordionSolution3">
<div class="accordion-body">
<ol style="list-style-type: decimal"><li><p>Consult <code>?PlantGrowth</code>, or check
<code>names(PlantGrowth)</code>. The data set compares the biomass
(<code>weight</code>) in a control and two treatment
conditions.</p></li>
<li>
</li>
</ol><div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">ggpubr</span><span class="op">)</span></span>
<span><span class="va">PlantGrowth</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">group</span>, y<span class="op">=</span><span class="va">weight</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">geom_jitter</span><span class="op">(</span>width<span class="op">=</span><span class="fl">0.1</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">stat_compare_means</span><span class="op">(</span>method<span class="op">=</span><span class="st">"anova"</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/Pairwise-comparisons-rendered-unnamed-chunk-8-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>The <code>stat_compare_means</code> function infers the comparisons
to be made from the <code>x</code> and <code>y</code> that we supplied
in the <code>aes</code>.</p>
</div>
</div>
</div>
</div>
<p>We saw that the <code>stat_compare_means</code> function allows you
to conveniently add the p-value of an ANOVA in the plot. We can also add
the p-values for individual comparisons:</p>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">PlantGrowth</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">group</span>, y<span class="op">=</span><span class="va">weight</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">geom_jitter</span><span class="op">(</span>width<span class="op">=</span><span class="fl">0.1</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">stat_compare_means</span><span class="op">(</span>method<span class="op">=</span><span class="st">"anova"</span>, label.y <span class="op">=</span> <span class="fl">7</span><span class="op">)</span><span class="op">+</span> </span>
<span>  <span class="fu">stat_compare_means</span><span class="op">(</span>comparisons<span class="op">=</span><span class="fu">list</span><span class="op">(</span> <span class="fu">c</span><span class="op">(</span><span class="st">"ctrl"</span>, <span class="st">"trt1"</span><span class="op">)</span>, <span class="fu">c</span><span class="op">(</span><span class="st">"ctrl"</span>, <span class="st">"trt2"</span><span class="op">)</span><span class="op">)</span>, method<span class="op">=</span><span class="st">"t.test"</span><span class="op">)</span>  </span></code></pre>
</div>
<figure><img src="fig/Pairwise-comparisons-rendered-unnamed-chunk-9-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>Explanations on the code above:</p>
<ul><li>The setting <code>label.y = 7</code> shifts the result of the ANOVA
to a height of <code>weight=7</code>, so it won’t overlap with the
individual results.</li>
<li>If we self-define the comparisons, we can do this via the
<code>comparisons</code> argument by supplying a list of the comparisons
to be made.</li>
</ul><p>For more examples with the package, look up <a href="http://www.sthda.com/english/articles/24-ggpubr-publication-ready-plots/76-add-p-values-and-significance-levels-to-ggplots/" class="external-link">this
page</a>.</p>
</div>
<div class="section level2">
<h2 id="p-value-hacking-and-data-snooping">p-value hacking and data snooping<a class="anchor" aria-label="anchor" href="#p-value-hacking-and-data-snooping"></a></h2>
<p>We learned in this lesson that performing a series of tests increases
the chances of having at least one false positive. Therefore, it is
important to be transparent about which tests were conducted during a
study. If we run a large screen and reported only the tests that came
out as hits, we’re skipping the type-I error control, and for someone
else it is not comprehensible how much the results can be trusted. In
fact, we could perform a screen of 1000 biological samples, where there
are <em>no</em> true positives. Still, if we run each test at <span class="math inline">\(\alpha=0.05\)</span>, we would have around 50
hits, which are all false positives. The practice of analyzing data
extensively, testing multiple hypotheses, or making comparisons until
finding a statistically significant result or an interesting pattern, is
called <em>p-value hacking</em>.</p>
<p>But even if this is not your intention, you may still sometimes be
tempted to <em>snoop</em> in the data, which is a more subtle way of
increasing type I error.</p>
<p>Reconsider the air pollution example above:</p>
<figure><img src="fig/Pairwise-comparisons-rendered-unnamed-chunk-10-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>In this example, we might visually inspect our plot, and decide to
perform only the comparison between very high and low. Why? Because it
<em>looks</em> most promising. With only one test performed, there is
also no possibility to perform correction for multiple testing, which
may seem sound, while in reality, you performed all the pairwise
comparisons by eye, without correcting for them. Therefore, unless you
<em>pre-specified</em> one particular test <em>before</em> you inspected
the data, all tests should be performed and reported. Otherwise, this
approach will lead to inflated Type I error rates.</p>
</div>
<div class="section level2">
<h2 id="additional-resources">Additional resources<a class="anchor" aria-label="anchor" href="#additional-resources"></a></h2>
<p>For further reading and hands-on practice with pairwise comparisons
in R, refer to <a href="%22https://www.rdocumentation.org/%22" class="external-link">R
documentation on pairwise comparisons</a>, <a href="%22https://www.coursera.org/specializations/statistics%22" class="external-link">Applied
Statistics with R</a> and <a href="%22http://users.stat.umn.edu/~gary/book/fcdae.pdf%22" class="external-link">book by
Oehlert 2010</a> resources.</p>

<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</div>
</div>



      </div> <!-- / div.lesson-content -->
    </main><!-- / main#main-content.main-content --><nav class="bottom-pagination mx-md-4" aria-label="Previous and Next Chapter"><div class="d-block d-sm-block d-md-none">
        <a class="chapter-link" href="False-discovery-rate.html"><i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>Previous</a>
        <a class="chapter-link float-end" href="Summary.html">Next<i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i></a>
      </div>
      <!-- content for large screens -->
      <div class="d-none d-sm-none d-md-block">
        <a class="chapter-link" href="False-discovery-rate.html" rel="prev">
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>
          Previous: False discovery rate
        </a>
        <a class="chapter-link float-end" href="Summary.html" rel="next">
          Next: Summary...
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i>
        </a>
      </div>
    </nav></div> <!-- / div.primary-content.col-xs-12 -->
<!-- END:   inst/pkgdown/templates/content-instructor.html-->

      </div><!--/div.row-->
      		<footer class="row footer mx-md-3"><hr><div class="col-md-6">
        <p>This lesson is subject to the <a href="CODE_OF_CONDUCT.html">Code of Conduct</a></p>
        <p>

        <a href="https://example.com/FIXME-template-source/edit/main/episodes/Pairwise-comparisons.Rmd" class="external-link">Edit on GitHub</a>

	
        | <a href="https://example.com/FIXME-template-source/blob/main/CONTRIBUTING.md" class="external-link">Contributing</a>
        | <a href="https://example.com/FIXME-template-source/" class="external-link">Source</a></p>
				<p><a href="https://example.com/FIXME-template-source/blob/main/CITATION" class="external-link">Cite</a> | <a href="mailto:sarah.kaspar@embl.de">Contact</a> | <a href="https://carpentries.org/about/" class="external-link">About</a></p>
			</div>
			<div class="col-md-6">

        <p>Materials licensed under <a href="LICENSE.html">CC-BY 4.0</a> by the authors</p>

        <p>Template licensed under <a href="https://creativecommons.org/licenses/by-sa/4.0/" class="external-link">CC-BY 4.0</a> by <a href="https://carpentries.org/" class="external-link">The Carpentries</a></p>
        <p>Built with <a href="https://github.com/carpentries/sandpaper/tree/0.16.6" class="external-link">sandpaper (0.16.6)</a>, <a href="https://github.com/carpentries/pegboard/tree/0.7.6" class="external-link">pegboard (0.7.6)</a>, and <a href="https://github.com/carpentries/varnish/tree/1.0.4" class="external-link">varnish (1.0.4)</a></p>
			</div>
		</footer></div> <!-- / div.container -->
	<div id="to-top">
		<a href="#top">
      <i class="search-icon" data-feather="arrow-up" role="img" aria-label="Back To Top"></i><br><!-- <span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top --><span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top
		</a>
	</div>
  <script type="application/ld+json">
    {
  "@context": "https://schema.org",
  "@type": "TrainingMaterial",
  "@id": "https://FIXME-template-source.github.io/NA/Pairwise-comparisons.html",
  "inLanguage": "en",
  "dct:conformsTo": "https://bioschemas.org/profiles/TrainingMaterial/1.0-RELEASE",
  "description": "A Carpentries Lesson teaching foundational data and coding skills to researchers worldwide",
  "keywords": "software, data, lesson, statistics",
  "name": "Pairwise comparisons",
  "creativeWorkStatus": "active",
  "url": "https://FIXME-template-source.github.io/NA/Pairwise-comparisons.html",
  "identifier": "https://FIXME-template-source.github.io/NA/Pairwise-comparisons.html",
  "dateCreated": "2024-04-18",
  "dateModified": "2024-09-03",
  "datePublished": "2024-09-03"
}

  </script><script>
		feather.replace();
	</script></body></html><!-- END:   inst/pkgdown/templates/layout.html-->

